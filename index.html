<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filecoin veFIL Governance Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f7fa;
            color: #2d3748;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Navigation */
        nav {
            background: linear-gradient(135deg, #0d1b2a 0%, #1b263b 100%);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .nav-logo {
            font-size: 1.4rem;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            letter-spacing: -0.5px;
        }

        .nav-logo::before {
            content: '';
            display: inline-block;
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #0066ff 0%, #00d4ff 100%);
            border-radius: 6px;
        }

        .nav-links {
            display: flex;
            gap: 0.5rem;
            list-style: none;
        }

        .nav-links a {
            text-decoration: none;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 500;
            font-size: 0.95rem;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            transition: all 0.2s;
            cursor: pointer;
        }

        .nav-links a:hover {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-links a.active {
            color: white;
            background: rgba(0, 102, 255, 0.3);
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .wallet-btn {
            background: linear-gradient(135deg, #0066ff 0%, #0052cc 100%);
            color: white;
            border: none;
            padding: 0.625rem 1.25rem;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .wallet-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 102, 255, 0.4);
        }

        .wallet-connected {
            background: rgba(0, 102, 255, 0.2);
            color: #66b3ff;
            padding: 0.625rem 1.25rem;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            border: 1px solid rgba(0, 102, 255, 0.4);
        }

        .lock-fil-nav-btn {
            background: transparent;
            color: #00d4ff;
            border: 1px solid #00d4ff;
            padding: 0.625rem 1.25rem;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .lock-fil-nav-btn:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        .lang-switcher {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            padding: 0.25rem;
        }

        .lang-btn {
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            padding: 0.375rem 0.625rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .lang-btn:hover {
            color: white;
        }

        .lang-btn.active {
            background: rgba(0, 102, 255, 0.5);
            color: white;
        }

        /* Main Content */
        main {
            min-height: calc(100vh - 200px);
            padding: 2rem 0;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Hero Section */
        .hero-section {
            margin-bottom: 2rem;
        }

        .hero-title-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .hero-title {
            font-size: 2rem;
            font-weight: 700;
            color: #1a202c;
            letter-spacing: -0.5px;
        }

        .hero-cta {
            background: linear-gradient(135deg, #0066ff 0%, #0052cc 100%);
            color: white;
            border: none;
            padding: 0.875rem 1.75rem;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .hero-cta:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 102, 255, 0.4);
        }

        .hero-cta svg {
            width: 18px;
            height: 18px;
        }

        .hero-description {
            background: linear-gradient(135deg, #f0f7ff 0%, #e6f2ff 100%);
            border-left: 4px solid #0066ff;
            padding: 1.25rem 1.5rem;
            border-radius: 0 12px 12px 0;
            margin-bottom: 2rem;
        }

        .hero-description p {
            color: #4a5568;
            font-size: 1rem;
            line-height: 1.7;
            margin: 0;
        }

        .hero-description .label {
            display: inline-block;
            background: #0066ff;
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.75rem;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .stat-label {
            color: #718096;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2d3748;
        }

        /* Filters */
        .filters {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .filter-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .filter-tab {
            padding: 0.5rem 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .filter-tab:hover {
            border-color: #0066ff;
        }

        .filter-tab.active {
            background: #0066ff;
            color: white;
            border-color: #0066ff;
        }

        .filter-tab .count {
            opacity: 0.7;
            margin-left: 0.5rem;
        }

        .search-sort {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
        }

        .sort-select {
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
        }

        /* Proposals List */
        .proposals-list {
            display: grid;
            gap: 1.5rem;
        }

        .proposal-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .proposal-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .proposal-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1rem;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .status-passed {
            background: #cce5ff;
            color: #004085;
        }

        .status-failed {
            background: #f8d7da;
            color: #721c24;
        }

        .status-upcoming {
            background: #fff3cd;
            color: #856404;
        }

        .proposal-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .proposal-meta {
            color: #718096;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .proposal-description {
            color: #4a5568;
            margin-bottom: 1rem;
        }

        .proposal-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }

        .proposal-stat {
            font-size: 0.9rem;
        }

        .proposal-stat-label {
            color: #718096;
            margin-bottom: 0.25rem;
        }

        .proposal-stat-value {
            font-weight: 600;
            color: #2d3748;
        }

        .progress-bar {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: #0066ff;
            transition: width 0.3s;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #718096;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Lock FIL Form */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #2d3748;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
        }

        .form-input:focus {
            outline: none;
            border-color: #0066ff;
        }

        .input-with-button {
            display: flex;
            gap: 0.5rem;
        }

        .input-with-button input {
            flex: 1;
        }

        .max-btn {
            padding: 0.75rem 1rem;
            background: #e6f2ff;
            color: #0066ff;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }

        .duration-presets {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .duration-preset {
            padding: 0.5rem;
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .duration-preset:hover,
        .duration-preset.active {
            background: #0066ff;
            color: white;
            border-color: #0066ff;
        }

        .preview-box {
            background: #f7fafc;
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1.5rem;
        }

        .preview-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
        }

        .preview-label {
            color: #718096;
        }

        .preview-value {
            font-weight: 600;
            color: #2d3748;
        }

        .btn-primary {
            background: #0066ff;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .btn-primary:hover {
            background: #0052cc;
        }

        .btn-primary:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }

        /* Proposal Detail */
        .proposal-detail {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .detail-header {
            margin-bottom: 2rem;
        }

        .detail-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .detail-meta {
            display: flex;
            gap: 2rem;
            color: #718096;
            flex-wrap: wrap;
        }

        .detail-body {
            margin-bottom: 2rem;
            line-height: 1.8;
        }

        .voting-module {
            background: #f7fafc;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .voting-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .vote-option {
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }

        .vote-option:hover {
            border-color: #0066ff;
        }

        .vote-option.selected {
            background: #0066ff;
            color: white;
            border-color: #0066ff;
        }

        .vote-option input[type="radio"] {
            display: none;
        }

        .results-module {
            background: white;
            padding: 2rem;
            border-radius: 12px;
        }

        .result-item {
            margin-bottom: 1.5rem;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .result-label {
            font-weight: 600;
        }

        .result-percentage {
            color: #718096;
        }

        .voter-table {
            margin-top: 2rem;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        th {
            background: #f7fafc;
            font-weight: 600;
            color: #4a5568;
        }

        tr:hover {
            background: #f7fafc;
        }

        /* Analytics */
        .analytics-header {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .analytics-toggle {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .toggle-btn {
            padding: 0.75rem 1.5rem;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .toggle-btn.active {
            background: #0066ff;
            color: white;
            border-color: #0066ff;
        }

        .chart-container {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .chart-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
        }

        .chart {
            height: 300px;
            display: flex;
            align-items: flex-end;
            gap: 0.5rem;
            padding: 1rem 0;
        }

        .bar {
            flex: 1;
            background: #0066ff;
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: all 0.3s;
        }

        .bar:hover {
            background: #0052cc;
        }

        .bar-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            color: #718096;
            white-space: nowrap;
        }

        /* Account Panel */
        .account-panel {
            position: fixed;
            right: -400px;
            top: 0;
            width: 400px;
            height: 100%;
            background: white;
            box-shadow: -2px 0 8px rgba(0,0,0,0.1);
            transition: right 0.3s;
            z-index: 200;
            overflow-y: auto;
        }

        .account-panel.active {
            right: 0;
        }

        .account-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .account-body {
            padding: 1.5rem;
        }

        .account-section {
            margin-bottom: 2rem;
        }

        .account-section-title {
            font-weight: 600;
            margin-bottom: 1rem;
            color: #4a5568;
        }

        .account-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
        }

        .account-label {
            color: #718096;
        }

        .account-value {
            font-weight: 600;
            color: #2d3748;
        }

        .claim-section {
            background: #f7fafc;
            padding: 1rem;
            border-radius: 8px;
        }

        /* Footer */
        footer {
            background: white;
            padding: 2rem 0;
            margin-top: 3rem;
            border-top: 1px solid #e2e8f0;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            list-style: none;
        }

        .footer-links a {
            color: #718096;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: #0066ff;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-links {
                gap: 1rem;
            }

            .hero-title {
                font-size: 1.5rem;
            }

            .hero-title-row {
                flex-direction: column;
                align-items: flex-start;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .account-panel {
                width: 100%;
                right: -100%;
            }
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 2rem;
            color: #718096;
        }

        /* Success Message */
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
        }

        .success-message.active {
            display: block;
        }

        /* Error Message */
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
        }

        .error-message.active {
            display: block;
        }

        /* Floating Feedback Button */
        .feedback-fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: #0066ff;
            color: white;
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 102, 255, 0.4);
            transition: all 0.3s;
            z-index: 99;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .feedback-fab:hover {
            background: #0052cc;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 102, 255, 0.5);
        }

        .feedback-fab svg {
            width: 20px;
            height: 20px;
        }

        /* Feedback Modal */
        .feedback-modal {
            display: none;
            position: fixed;
            bottom: 6rem;
            right: 2rem;
            width: 360px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            z-index: 100;
            overflow: hidden;
        }

        .feedback-modal.active {
            display: block;
        }

        .feedback-header {
            background: #0066ff;
            color: white;
            padding: 1.25rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .feedback-header h3 {
            margin: 0;
            font-size: 1.1rem;
        }

        .feedback-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            line-height: 1;
        }

        .feedback-body {
            padding: 1.5rem;
        }

        .feedback-type-selector {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .feedback-type-btn {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .feedback-type-btn:hover {
            border-color: #0066ff;
        }

        .feedback-type-btn.active {
            background: #e6f2ff;
            border-color: #0066ff;
            color: #0066ff;
        }

        .feedback-textarea {
            width: 100%;
            min-height: 120px;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 1rem;
        }

        .feedback-textarea:focus {
            outline: none;
            border-color: #0066ff;
        }

        .feedback-submit {
            width: 100%;
            background: #0066ff;
            color: white;
            border: none;
            padding: 0.875rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.3s;
        }

        .feedback-submit:hover {
            background: #0052cc;
        }

        @media (max-width: 480px) {
            .feedback-modal {
                width: calc(100% - 2rem);
                right: 1rem;
                bottom: 5rem;
            }

            .feedback-fab {
                right: 1rem;
                bottom: 1rem;
            }
        }

        /* Demo Badge */
        .demo-badge {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931a 100%);
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 0.75rem;
            animation: pulse-badge 2s infinite;
        }

        @keyframes pulse-badge {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Tooltip Styles */
        .tooltip-trigger {
            position: relative;
            cursor: help;
            border-bottom: 1px dotted #0066ff;
            display: inline;
        }

        .tooltip-trigger::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1a202c;
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 400;
            line-height: 1.5;
            white-space: normal;
            width: max-content;
            max-width: 280px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            pointer-events: none;
            margin-bottom: 8px;
        }

        .tooltip-trigger::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: #1a202c;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            z-index: 1001;
            margin-bottom: -4px;
        }

        .tooltip-trigger:hover::after,
        .tooltip-trigger:hover::before {
            opacity: 1;
            visibility: visible;
        }

        /* Wallet Disclaimer Modal */
        .wallet-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 300;
            justify-content: center;
            align-items: center;
        }

        .wallet-modal.active {
            display: flex;
        }

        .wallet-modal-content {
            background: white;
            border-radius: 16px;
            max-width: 480px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .wallet-modal-header {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931a 100%);
            color: white;
            padding: 1.5rem;
            text-align: center;
        }

        .wallet-modal-header svg {
            width: 48px;
            height: 48px;
            margin-bottom: 0.75rem;
        }

        .wallet-modal-header h2 {
            margin: 0;
            font-size: 1.5rem;
        }

        .wallet-modal-body {
            padding: 1.5rem;
        }

        .wallet-disclaimer {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .wallet-disclaimer-title {
            font-weight: 700;
            color: #856404;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .wallet-disclaimer p {
            color: #856404;
            font-size: 0.95rem;
            margin: 0;
            line-height: 1.6;
        }

        .wallet-features {
            margin-bottom: 1.5rem;
        }

        .wallet-feature {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            color: #4a5568;
        }

        .wallet-feature svg {
            width: 20px;
            height: 20px;
            color: #10b981;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .wallet-modal-footer {
            display: flex;
            gap: 1rem;
            padding: 0 1.5rem 1.5rem;
        }

        .wallet-modal-footer button {
            flex: 1;
            padding: 0.875rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .wallet-cancel-btn {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            color: #4a5568;
        }

        .wallet-cancel-btn:hover {
            background: #edf2f7;
        }

        .wallet-continue-btn {
            background: linear-gradient(135deg, #0066ff 0%, #0052cc 100%);
            border: none;
            color: white;
        }

        .wallet-continue-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 102, 255, 0.4);
        }

        /* Info Page Styles */
        .info-page {
            max-width: 800px;
            margin: 0 auto;
        }

        .info-section {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .info-section h2 {
            color: #1a202c;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .info-section h2 svg {
            width: 28px;
            height: 28px;
            color: #0066ff;
        }

        .info-section p {
            color: #4a5568;
            line-height: 1.8;
            margin-bottom: 1rem;
        }

        .info-section p:last-child {
            margin-bottom: 0;
        }

        .info-highlight {
            background: linear-gradient(135deg, #f0f7ff 0%, #e6f2ff 100%);
            border-left: 4px solid #0066ff;
            padding: 1.25rem 1.5rem;
            border-radius: 0 8px 8px 0;
            margin: 1.5rem 0;
        }

        .info-highlight p {
            margin: 0;
            font-style: italic;
        }

        .info-list {
            list-style: none;
            padding: 0;
            margin: 1rem 0;
        }

        .info-list li {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            color: #4a5568;
        }

        .info-list li svg {
            width: 20px;
            height: 20px;
            color: #10b981;
            flex-shrink: 0;
            margin-top: 2px;
        }

        /* Community Feedback Page Styles */
        .feedback-page-header {
            margin-bottom: 2rem;
        }

        .feedback-page-header h1 {
            font-size: 2rem;
            color: #1a202c;
            margin-bottom: 0.5rem;
        }

        .feedback-page-header p {
            color: #718096;
            font-size: 1.1rem;
        }

        .suggestion-form {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .suggestion-form h3 {
            margin-bottom: 1rem;
            color: #1a202c;
        }

        .suggestion-input {
            width: 100%;
            padding: 0.875rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 1rem;
            font-family: inherit;
        }

        .suggestion-input:focus {
            outline: none;
            border-color: #0066ff;
        }

        .suggestion-textarea {
            min-height: 80px;
            resize: vertical;
        }

        .suggestion-submit {
            background: linear-gradient(135deg, #0066ff 0%, #0052cc 100%);
            color: white;
            border: none;
            padding: 0.875rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .suggestion-submit:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 102, 255, 0.4);
        }

        .suggestions-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .suggestion-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 1rem;
        }

        .suggestion-votes {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 60px;
        }

        .vote-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            color: #a0aec0;
            transition: all 0.2s;
        }

        .vote-btn:hover {
            color: #0066ff;
        }

        .vote-btn.voted-up {
            color: #10b981;
        }

        .vote-btn.voted-down {
            color: #ef4444;
        }

        .vote-btn svg {
            width: 24px;
            height: 24px;
        }

        .vote-count {
            font-size: 1.25rem;
            font-weight: 700;
            color: #2d3748;
        }

        .suggestion-content {
            flex: 1;
        }

        .suggestion-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1a202c;
            margin-bottom: 0.5rem;
        }

        .suggestion-description {
            color: #718096;
            line-height: 1.6;
            margin-bottom: 0.75rem;
        }

        .suggestion-meta {
            font-size: 0.85rem;
            color: #a0aec0;
        }

        .suggestion-tag {
            display: inline-block;
            background: #e6f2ff;
            color: #0066ff;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        .suggestion-tag.feature {
            background: #d4edda;
            color: #155724;
        }

        .suggestion-tag.improvement {
            background: #fff3cd;
            color: #856404;
        }

        .suggestion-tag.bug {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <div class="nav-logo">veFIL Governance<span class="demo-badge" data-i18n="demoBadge">Demo</span></div>
            <ul class="nav-links">
                <li><a href="#" class="nav-link active" data-page="proposals" data-i18n="navProposals">Proposals</a></li>
                <li><a href="#" class="nav-link" data-page="analytics" data-i18n="navAnalytics">Analytics</a></li>
                <li><a href="#" class="nav-link" data-page="info" data-i18n="navInfo">Info</a></li>
                <li><a href="#" class="nav-link" data-page="community-feedback" data-i18n="navCommunityFeedback">Feedback</a></li>
            </ul>
            <div class="nav-right">
                <div class="lang-switcher">
                    <button class="lang-btn active" data-lang="en" onclick="switchLanguage('en')">EN</button>
                    <button class="lang-btn" data-lang="zh" onclick="switchLanguage('zh')">中文</button>
                </div>
                <button class="lock-fil-nav-btn" onclick="openLockModal()" data-i18n="lockFil">Lock FIL</button>
                <button class="wallet-btn" id="walletBtn" data-i18n="connectWallet">Connect Wallet</button>
            </div>
        </div>
    </nav>

    <main>
        <!-- Proposals Page -->
        <div id="proposals" class="page active">
            <div class="container">
                <div class="hero-section">
                    <div class="hero-title-row">
                        <h1 class="hero-title"><span class="tooltip-trigger" data-tooltip="Vote-escrowed FIL: A governance token earned by locking FIL. Longer lock periods = more voting power." data-i18n-tooltip="tooltipVeFIL">veFIL</span> <span data-i18n="heroTitleVoting">Voting</span> <span class="tooltip-trigger" data-tooltip="This is a demonstration environment. No real tokens, wallets, or funds are used." data-i18n-tooltip="tooltipPrototype">Prototype</span></h1>
                        <button class="hero-cta" id="lockFILBannerBtn">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                            </svg>
                            <span data-i18n="lockFil">Lock FIL</span>
                        </button>
                    </div>
                    <div class="hero-description">
                        <span class="label" data-i18n="testEnv">Prototype - No Real Funds</span>
                        <p data-i18n="heroDesc">Try out minting <span class="tooltip-trigger" data-tooltip="Vote-escrowed FIL: Governance tokens received when you lock FIL. The longer you lock, the more veFIL you receive." data-i18n-tooltip="tooltipVeFIL">veFIL</span> and voting on proposals that shape the future of Filecoin. <strong>This is a demonstration environment only.</strong> No real wallets are connected and no actual funds are used. All data shown is simulated for testing purposes.</p>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label" data-i18n="totalVeFIL">Total veFIL</div>
                        <div class="stat-value" id="totalVeFIL">1,234,567</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label" data-i18n="totalVoters">Total Voters</div>
                        <div class="stat-value" id="totalVoters">2,456</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label" data-i18n="activeProposals">Active Proposals</div>
                        <div class="stat-value" id="activeProposals">8</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label" data-i18n="totalLockedFIL">Total Locked FIL</div>
                        <div class="stat-value" id="totalLocked">987,654</div>
                    </div>
                </div>

                <div class="filters">
                    <div class="filter-tabs">
                        <button class="filter-tab" data-filter="all"><span data-i18n="filterAll">All</span> <span class="count" id="countAll"></span></button>
                        <button class="filter-tab active" data-filter="active"><span data-i18n="filterActive">Active</span> <span class="count" id="countActive"></span></button>
                        <button class="filter-tab" data-filter="passed"><span data-i18n="filterPassed">Passed</span> <span class="count" id="countPassed"></span></button>
                        <button class="filter-tab" data-filter="failed"><span data-i18n="filterFailed">Failed</span> <span class="count" id="countFailed"></span></button>
                        <button class="filter-tab" data-filter="upcoming"><span data-i18n="filterUpcoming">Upcoming</span> <span class="count" id="countUpcoming"></span></button>
                    </div>
                    <div class="search-sort">
                        <input type="text" class="search-box" data-i18n-placeholder="searchPlaceholder" placeholder="Search proposals..." id="searchBox">
                        <select class="sort-select" id="sortSelect">
                            <option value="ending-soon" data-i18n="sortEndingSoon">Ending Soon</option>
                            <option value="newest" data-i18n="sortNewest">Newest</option>
                            <option value="oldest" data-i18n="sortOldest">Oldest</option>
                        </select>
                    </div>
                </div>

                <div class="proposals-list" id="proposalsList"></div>
            </div>
        </div>

        <!-- Analytics Page -->
        <div id="analytics" class="page">
            <div class="container">
                <div class="analytics-header">
                    <h1 data-i18n="analyticsTitle">Governance Analytics</h1>
                    <p data-i18n="analyticsDesc">Track participation, decentralization, and deposit patterns</p>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label" data-i18n="totalVeFIL">Total veFIL</div>
                            <div class="stat-value">1,234,567</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label" data-i18n="totalLockedFIL">Total Locked FIL</div>
                            <div class="stat-value">987,654</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label" data-i18n="totalHolders">Total Holders</div>
                            <div class="stat-value">2,456</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label" data-i18n="avgLockDuration">Avg Lock Duration</div>
                            <div class="stat-value" data-i18n="days127">127 days</div>
                        </div>
                    </div>
                    <div class="analytics-toggle">
                        <button class="toggle-btn active" data-view="deposits" data-i18n="depositDistribution">Deposit Distribution</button>
                        <button class="toggle-btn" data-view="holders" data-i18n="holderDistribution">Holder Distribution</button>
                    </div>
                </div>

                <div id="depositsView" class="analytics-view">
                    <div class="chart-container">
                        <h2 class="chart-title" data-i18n="depositsChartTitle">veFIL Deposits Last 8 Weeks</h2>
                        <div class="chart" id="depositsChart"></div>
                    </div>
                    <div class="chart-container">
                        <h2 class="chart-title" data-i18n="depositTableTitle">Deposit Distribution Table</h2>
                        <div class="table-container">
                            <table id="depositsTable">
                                <thead>
                                    <tr>
                                        <th data-i18n="thWeek">Week</th>
                                        <th data-i18n="thTotalDeposits">Total Deposits (FIL)</th>
                                        <th data-i18n="thDateRange">Date Range</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="holdersView" class="analytics-view" style="display: none;">
                    <div class="chart-container">
                        <h2 class="chart-title" data-i18n="holderChartTitle">veFIL Holder Distribution</h2>
                        <div class="chart" id="holdersChart"></div>
                    </div>
                    <div class="chart-container">
                        <h2 class="chart-title" data-i18n="topHolders">Top Holders</h2>
                        <div class="table-container">
                            <table id="holdersTable">
                                <thead>
                                    <tr>
                                        <th data-i18n="thRank">Rank</th>
                                        <th data-i18n="thAddress">Address</th>
                                        <th>veFIL</th>
                                        <th data-i18n="thShare">Share %</th>
                                        <th>Unlock Time</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Info Page -->
        <div id="info" class="page">
            <div class="container info-page">
                <div class="info-section">
                    <h2>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span data-i18n="infoAboutTitle">About This Prototype</span>
                    </h2>
                    <div class="wallet-disclaimer" style="margin-bottom: 1rem;">
                        <div class="wallet-disclaimer-title">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            <span data-i18n="infoDisclaimerTitle">Demonstration Only</span>
                        </div>
                        <p data-i18n="infoDisclaimerText">This is a prototype environment for exploring veFIL governance concepts. No real wallets, tokens, or funds are used. All data is simulated for demonstration purposes.</p>
                    </div>
                    <p data-i18n="infoAboutDesc">This prototype demonstrates how vote-escrowed FIL (veFIL) governance could work on the Filecoin network. It allows you to explore the user experience of locking FIL to receive voting power and participating in governance proposals.</p>
                </div>

                <div class="info-section">
                    <h2>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                        </svg>
                        <span data-i18n="infoVeModelTitle">The Vote-Escrowed Model</span>
                    </h2>
                    <div class="info-highlight">
                        <p data-i18n="infoVeModelHighlight">The vote-escrowed model is a well-established mechanism in DeFi and blockchain governance that rewards long-term commitment and aligns token holders' interests with the protocol's long-term success.</p>
                    </div>
                    <p data-i18n="infoVeModelDesc1">By giving more voting power to those with a longer-term stake, the network can ensure that decisions are made by those who are most invested in the future of the network.</p>
                    <p data-i18n="infoVeModelDesc2">This model provides a transparent framework for governing public goods funding, moving further towards a more decentralized and community-driven approach.</p>
                </div>

                <div class="info-section">
                    <h2>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                        </svg>
                        <span data-i18n="infoGlossaryTitle">Key Terms</span>
                    </h2>
                    <ul class="info-list">
                        <li>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            <div><strong>veFIL (Vote-Escrowed FIL):</strong> <span data-i18n="glossaryVeFIL">A governance token received when you lock FIL. The amount of veFIL you receive depends on both the amount locked and the lock duration. Longer locks = more veFIL = more voting power.</span></div>
                        </li>
                        <li>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            <div><strong>Quorum:</strong> <span data-i18n="glossaryQuorum">The minimum percentage of total veFIL that must participate in a vote for it to be valid. This ensures decisions have sufficient community support.</span></div>
                        </li>
                        <li>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            <div><strong>Lock Duration:</strong> <span data-i18n="glossaryLockDuration">The time period for which your FIL is locked. Ranges from 7 days to 2 years (730 days). Longer durations provide more veFIL.</span></div>
                        </li>
                        <li>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            <div><strong>Snapshot Block:</strong> <span data-i18n="glossarySnapshot">The block height at which veFIL balances are recorded for voting eligibility. Only veFIL held at this block can vote on the proposal.</span></div>
                        </li>
                        <li>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            <div><strong>FIP (Filecoin Improvement Proposal):</strong> <span data-i18n="glossaryFIP">A formal document proposing changes or improvements to the Filecoin network. FIPs go through community review before implementation.</span></div>
                        </li>
                    </ul>
                </div>

                <div class="info-section">
                    <h2>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                        </svg>
                        <span data-i18n="infoFormulaTitle">veFIL Formula</span>
                    </h2>
                    <p data-i18n="infoFormulaDesc">The amount of veFIL you receive is calculated based on your lock amount and duration:</p>
                    <div class="info-highlight">
                        <p><strong>veFIL = FIL Amount × (Lock Days / 730) × Multiplier</strong></p>
                    </div>
                    <p data-i18n="infoFormulaExample">For example, locking 100 FIL for 365 days (1 year) would give you: 100 × (365/730) × 1 = 50 veFIL</p>
                </div>
            </div>
        </div>

        <!-- Community Feedback Page -->
        <div id="community-feedback" class="page">
            <div class="container">
                <div class="feedback-page-header">
                    <h1 data-i18n="feedbackPageTitle">Community Feedback</h1>
                    <p data-i18n="feedbackPageDesc">Share your ideas, vote on suggestions from others, and help shape the future of veFIL governance.</p>
                </div>

                <div class="suggestion-form">
                    <h3 data-i18n="suggestFeature">Suggest a Feature or Improvement</h3>
                    <input type="text" class="suggestion-input" id="suggestionTitle" placeholder="Feature title..." data-i18n-placeholder="suggestionTitlePlaceholder">
                    <textarea class="suggestion-input suggestion-textarea" id="suggestionDesc" placeholder="Describe your suggestion..." data-i18n-placeholder="suggestionDescPlaceholder"></textarea>
                    <select class="suggestion-input" id="suggestionType" style="margin-bottom: 1rem;">
                        <option value="feature" data-i18n="typeFeature">New Feature</option>
                        <option value="improvement" data-i18n="typeImprovement">Improvement</option>
                        <option value="bug" data-i18n="typeBugFix">Bug Fix</option>
                    </select>
                    <button class="suggestion-submit" onclick="addSuggestion()" data-i18n="submitSuggestion">Submit Suggestion</button>
                </div>

                <h3 style="margin-bottom: 1rem;" data-i18n="communitySuggestions">Community Suggestions</h3>
                <div class="suggestions-list" id="suggestionsList"></div>
            </div>
        </div>
    </main>

    <!-- Wallet Disclaimer Modal -->
    <div class="wallet-modal" id="walletDisclaimerModal">
        <div class="wallet-modal-content">
            <div class="wallet-modal-header">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
                <h2 data-i18n="walletModalTitle">Demo Mode Only</h2>
            </div>
            <div class="wallet-modal-body">
                <div class="wallet-disclaimer">
                    <div class="wallet-disclaimer-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                        </svg>
                        <span data-i18n="walletDisclaimerTitle">This is NOT a Real Wallet</span>
                    </div>
                    <p data-i18n="walletDisclaimerText">You are connecting to a simulated demo wallet. No real cryptocurrency, tokens, or funds are involved. This is purely for demonstration purposes.</p>
                </div>
                <div class="wallet-features">
                    <div class="wallet-feature">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        <span data-i18n="walletFeature1">No real FIL or crypto is used</span>
                    </div>
                    <div class="wallet-feature">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        <span data-i18n="walletFeature2">All balances are simulated demo data</span>
                    </div>
                    <div class="wallet-feature">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        <span data-i18n="walletFeature3">Safe to explore without any risk</span>
                    </div>
                    <div class="wallet-feature">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        <span data-i18n="walletFeature4">Votes and transactions are not recorded on-chain</span>
                    </div>
                </div>
            </div>
            <div class="wallet-modal-footer">
                <button class="wallet-cancel-btn" onclick="closeWalletDisclaimer()" data-i18n="walletCancel">Cancel</button>
                <button class="wallet-continue-btn" onclick="proceedWithDemoWallet()" data-i18n="walletContinue">I Understand, Continue</button>
            </div>
        </div>
    </div>

    <!-- Lock FIL Modal -->
    <div class="modal" id="lockModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Lock FIL</h2>
                <button class="modal-close" onclick="closeLockModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="success-message" id="lockSuccess"></div>
                <div class="error-message" id="lockError"></div>
                
                <div class="form-group">
                    <label class="form-label">Lock Amount (FIL)</label>
                    <div class="input-with-button">
                        <input type="number" class="form-input" id="lockAmount" placeholder="0.00" min="0" step="0.01">
                        <button class="max-btn" onclick="setMaxAmount()">MAX</button>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Lock Duration</label>
                    <div class="duration-presets">
                        <button class="duration-preset" data-days="7">7 days</button>
                        <button class="duration-preset" data-days="30">30 days</button>
                        <button class="duration-preset" data-days="90">90 days</button>
                        <button class="duration-preset" data-days="180">180 days</button>
                        <button class="duration-preset" data-days="365">1 year</button>
                        <button class="duration-preset" data-days="730">2 years</button>
                    </div>
                    <input type="range" class="form-input" id="durationSlider" min="7" max="730" value="90" style="margin-top: 1rem;">
                    <div style="text-align: center; color: #718096; margin-top: 0.5rem;">
                        <span id="selectedDuration">90</span> days
                    </div>
                </div>

                <div class="preview-box">
                    <h3 style="margin-bottom: 1rem; font-size: 1.1rem;">Preview</h3>
                    <div class="preview-item">
                        <span class="preview-label">You will receive</span>
                        <span class="preview-value" id="previewVeFIL">0 veFIL</span>
                    </div>
                    <div class="preview-item">
                        <span class="preview-label">Lock multiplier</span>
                        <span class="preview-value" id="previewMultiplier">1.00x</span>
                    </div>
                    <div class="preview-item">
                        <span class="preview-label">Lock ends on</span>
                        <span class="preview-value" id="previewEndDate">-</span>
                    </div>
                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e2e8f0; font-size: 0.9rem; color: #718096;">
                        <strong>Formula:</strong> veFIL = FIL × (lock days / 730) × multiplier
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeLockModal()">Cancel</button>
                <button class="btn-primary" id="lockContinueBtn" disabled onclick="submitLock()">Continue</button>
            </div>
        </div>
    </div>

    <!-- Proposal Detail Modal -->
    <div class="modal" id="proposalModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 class="modal-title" id="proposalModalTitle">Proposal Details</h2>
                <button class="modal-close" onclick="closeProposalModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="success-message" id="voteSuccess"></div>
                <div class="error-message" id="voteError"></div>
                
                <div class="proposal-detail" id="proposalDetailContent"></div>
                
                <div class="voting-module" id="votingModule" style="display: none;">
                    <h3 style="margin-bottom: 1rem;">Cast Your Vote</h3>
                    <div class="voting-options">
                        <label class="vote-option">
                            <input type="radio" name="vote" value="for">
                            <div>✓ For</div>
                        </label>
                        <label class="vote-option">
                            <input type="radio" name="vote" value="against">
                            <div>✗ Against</div>
                        </label>
                        <label class="vote-option">
                            <input type="radio" name="vote" value="abstain">
                            <div>− Abstain</div>
                        </label>
                    </div>
                    <button class="btn-primary" id="submitVoteBtn" disabled onclick="submitVote()" style="width: 100%;">Submit Vote</button>
                </div>

                <div class="results-module" id="resultsModule"></div>
            </div>
        </div>
    </div>

    <!-- Account Panel -->
    <div class="account-panel" id="accountPanel">
        <div class="account-header">
            <h2>My Account</h2>
            <button class="modal-close" onclick="closeAccountPanel()">&times;</button>
        </div>
        <div class="account-body">
            <div class="account-section">
                <div class="account-section-title">Wallet</div>
                <div class="account-item">
                    <span class="account-label">Address</span>
                    <span class="account-value" id="accountAddress">-</span>
                </div>
                <button class="btn-secondary" onclick="disconnectWallet()" style="width: 100%; margin-top: 0.5rem;">Disconnect</button>
            </div>

            <div class="account-section">
                <div class="account-section-title">Balances</div>
                <div class="account-item">
                    <span class="account-label">FIL Balance</span>
                    <span class="account-value" id="accountFIL">0 FIL</span>
                </div>
                <div class="account-item">
                    <span class="account-label">Locked FIL</span>
                    <span class="account-value" id="accountLockedFIL">0 FIL</span>
                </div>
                <div class="account-item">
                    <span class="account-label">Your veFIL</span>
                    <span class="account-value" id="accountVeFIL">0 veFIL</span>
                </div>
                <div class="account-item">
                    <span class="account-label">Estimated APR</span>
                    <span class="account-value" id="accountAPR">0%</span>
                </div>
            </div>

            <div class="account-section">
                <div class="account-section-title">Active Locks</div>
                <div id="activeLocks">
                    <p style="color: #718096; text-align: center;">No active locks</p>
                </div>
            </div>

            <div class="account-section claim-section">
                <div class="account-section-title">Rewards</div>
                <div class="account-item">
                    <span class="account-label">Claimable</span>
                    <span class="account-value" id="accountClaimable">0 FIL</span>
                </div>
                <button class="btn-primary" id="claimBtn" disabled onclick="claimRewards()" style="width: 100%; margin-top: 1rem;">Claim Rewards</button>
            </div>

            <button class="btn-primary" onclick="openLockModal()" style="width: 100%; margin-top: 1rem;">Lock FIL</button>
        </div>
    </div>

    <!-- Floating Feedback Button -->
    <button class="feedback-fab" onclick="toggleFeedbackModal()">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
        </svg>
        <span data-i18n="feedback">Feedback</span>
    </button>

    <!-- Feedback Modal -->
    <div class="feedback-modal" id="feedbackModal">
        <div class="feedback-header">
            <h3 data-i18n="sendFeedback">Send Feedback</h3>
            <button class="feedback-close" onclick="toggleFeedbackModal()">&times;</button>
        </div>
        <div class="feedback-body">
            <div class="feedback-type-selector">
                <button class="feedback-type-btn active" data-type="feedback" onclick="selectFeedbackType(this)">💡 <span data-i18n="feedback">Feedback</span></button>
                <button class="feedback-type-btn" data-type="bug" onclick="selectFeedbackType(this)">🐛 <span data-i18n="bugReport">Bug Report</span></button>
            </div>
            <textarea class="feedback-textarea" id="feedbackMessage" data-i18n-placeholder="feedbackPlaceholder" placeholder="Tell us what's on your mind..."></textarea>
            <button class="feedback-submit" onclick="submitFeedback()" data-i18n="sendFeedback">Send Feedback</button>
        </div>
    </div>

    <footer>
        <div class="container">
            <ul class="footer-links">
                <li><a href="https://docs.filecoin.io" target="_blank">Docs</a></li>
                <li><a href="https://github.com/filecoin-project/FIPs" target="_blank">FIPs</a></li>
                <li><a href="https://filecoin.io" target="_blank">Filecoin</a></li>
                <li><a href="https://gleaming-kangaroo-96077c.netlify.app/" target="_blank">Tokenomics Workbench</a></li>
            </ul>
        </div>
    </footer>

    <script>
        // Translations
        const translations = {
            en: {
                // Navigation
                navProposals: 'Proposals',
                navAnalytics: 'Analytics',
                lockFil: 'Lock FIL',
                connectWallet: 'Connect Wallet',

                // Hero Section
                heroTitle: 'veFIL Voting Prototype',
                testEnv: 'Test Environment',
                heroDesc: 'Try out minting veFIL and voting on proposals that shape the future of Filecoin. This is a prototype environment and is not linked to real wallets or stake.',

                // Stats
                totalVeFIL: 'Total veFIL',
                totalVoters: 'Total Voters',
                activeProposals: 'Active Proposals',
                totalLockedFIL: 'Total Locked FIL',
                totalHolders: 'Total Holders',
                avgLockDuration: 'Avg Lock Duration',
                days127: '127 days',

                // Filters
                filterAll: 'All',
                filterActive: 'Active',
                filterPassed: 'Passed',
                filterFailed: 'Failed',
                filterUpcoming: 'Upcoming',
                searchPlaceholder: 'Search proposals...',
                sortEndingSoon: 'Ending Soon',
                sortNewest: 'Newest',
                sortOldest: 'Oldest',

                // Analytics
                analyticsTitle: 'Governance Analytics',
                analyticsDesc: 'Track participation, decentralization, and deposit patterns',
                depositDistribution: 'Deposit Distribution',
                holderDistribution: 'Holder Distribution',
                depositsChartTitle: 'veFIL Deposits Last 8 Weeks',
                depositTableTitle: 'Deposit Distribution Table',
                holderChartTitle: 'veFIL Holder Distribution',
                topHolders: 'Top Holders',

                // Table Headers
                thWeek: 'Week',
                thTotalDeposits: 'Total Deposits (FIL)',
                thDateRange: 'Date Range',
                thRank: 'Rank',
                thAddress: 'Address',
                thShare: 'Share %',
                thUnlockTime: 'Unlock Time',

                // Feedback
                feedback: 'Feedback',
                sendFeedback: 'Send Feedback',
                bugReport: 'Bug Report',
                feedbackPlaceholder: 'Tell us what\'s on your mind...',

                // Proposal Cards
                proposedBy: 'Proposed by',
                created: 'Created',
                quorumProgress: 'Quorum Progress',
                totalVotes: 'Total Votes',
                currentSplit: 'Current Split',
                upcoming: 'Upcoming',
                daysRemaining: 'days remaining',
                startsIn: 'Starts in',
                ended: 'Ended',

                // Navigation & Header
                navInfo: 'Info',
                navCommunityFeedback: 'Feedback',
                demoBadge: 'Demo',
                heroTitleVoting: 'Voting',

                // Tooltips
                tooltipVeFIL: 'Vote-escrowed FIL: A governance token earned by locking FIL. Longer lock periods = more voting power.',
                tooltipPrototype: 'This is a demonstration environment. No real tokens, wallets, or funds are used.',
                tooltipQuorum: 'The minimum participation required for a valid vote.',

                // Wallet Modal
                walletModalTitle: 'Demo Mode Only',
                walletDisclaimerTitle: 'This is NOT a Real Wallet',
                walletDisclaimerText: 'You are connecting to a simulated demo wallet. No real cryptocurrency, tokens, or funds are involved. This is purely for demonstration purposes.',
                walletFeature1: 'No real FIL or crypto is used',
                walletFeature2: 'All balances are simulated demo data',
                walletFeature3: 'Safe to explore without any risk',
                walletFeature4: 'Votes and transactions are not recorded on-chain',
                walletCancel: 'Cancel',
                walletContinue: 'I Understand, Continue',

                // Info Page
                infoAboutTitle: 'About This Prototype',
                infoDisclaimerTitle: 'Demonstration Only',
                infoDisclaimerText: 'This is a prototype environment for exploring veFIL governance concepts. No real wallets, tokens, or funds are used. All data is simulated for demonstration purposes.',
                infoAboutDesc: 'This prototype demonstrates how vote-escrowed FIL (veFIL) governance could work on the Filecoin network. It allows you to explore the user experience of locking FIL to receive voting power and participating in governance proposals.',
                infoVeModelTitle: 'The Vote-Escrowed Model',
                infoVeModelHighlight: 'The vote-escrowed model is a well-established mechanism in DeFi and blockchain governance that rewards long-term commitment and aligns token holders\' interests with the protocol\'s long-term success.',
                infoVeModelDesc1: 'By giving more voting power to those with a longer-term stake, the network can ensure that decisions are made by those who are most invested in the future of the network.',
                infoVeModelDesc2: 'This model provides a transparent framework for governing public goods funding, moving further towards a more decentralized and community-driven approach.',
                infoGlossaryTitle: 'Key Terms',
                glossaryVeFIL: 'A governance token received when you lock FIL. The amount of veFIL you receive depends on both the amount locked and the lock duration. Longer locks = more veFIL = more voting power.',
                glossaryQuorum: 'The minimum percentage of total veFIL that must participate in a vote for it to be valid. This ensures decisions have sufficient community support.',
                glossaryLockDuration: 'The time period for which your FIL is locked. Ranges from 7 days to 2 years (730 days). Longer durations provide more veFIL.',
                glossarySnapshot: 'The block height at which veFIL balances are recorded for voting eligibility. Only veFIL held at this block can vote on the proposal.',
                glossaryFIP: 'A formal document proposing changes or improvements to the Filecoin network. FIPs go through community review before implementation.',
                infoFormulaTitle: 'veFIL Formula',
                infoFormulaDesc: 'The amount of veFIL you receive is calculated based on your lock amount and duration:',
                infoFormulaExample: 'For example, locking 100 FIL for 365 days (1 year) would give you: 100 × (365/730) × 1 = 50 veFIL',

                // Community Feedback Page
                feedbackPageTitle: 'Community Feedback',
                feedbackPageDesc: 'Share your ideas, vote on suggestions from others, and help shape the future of veFIL governance.',
                suggestFeature: 'Suggest a Feature or Improvement',
                suggestionTitlePlaceholder: 'Feature title...',
                suggestionDescPlaceholder: 'Describe your suggestion...',
                typeFeature: 'New Feature',
                typeImprovement: 'Improvement',
                typeBugFix: 'Bug Fix',
                submitSuggestion: 'Submit Suggestion',
                communitySuggestions: 'Community Suggestions'
            },
            zh: {
                // Navigation
                navProposals: '提案',
                navAnalytics: '数据分析',
                lockFil: '锁定 FIL',
                connectWallet: '连接钱包',

                // Hero Section
                heroTitle: 'veFIL 投票原型',
                testEnv: '测试环境',
                heroDesc: '尝试铸造 veFIL 并对塑造 Filecoin 未来的提案进行投票。这是一个原型环境，未与真实钱包或质押关联。',

                // Stats
                totalVeFIL: 'veFIL 总量',
                totalVoters: '投票者总数',
                activeProposals: '活跃提案',
                totalLockedFIL: '锁定 FIL 总量',
                totalHolders: '持有者总数',
                avgLockDuration: '平均锁定期',
                days127: '127 天',

                // Filters
                filterAll: '全部',
                filterActive: '进行中',
                filterPassed: '已通过',
                filterFailed: '未通过',
                filterUpcoming: '即将开始',
                searchPlaceholder: '搜索提案...',
                sortEndingSoon: '即将结束',
                sortNewest: '最新',
                sortOldest: '最早',

                // Analytics
                analyticsTitle: '治理数据分析',
                analyticsDesc: '追踪参与度、去中心化程度和存款模式',
                depositDistribution: '存款分布',
                holderDistribution: '持有者分布',
                depositsChartTitle: '近8周 veFIL 存款',
                depositTableTitle: '存款分布表',
                holderChartTitle: 'veFIL 持有者分布',
                topHolders: '主要持有者',

                // Table Headers
                thWeek: '周',
                thTotalDeposits: '存款总额 (FIL)',
                thDateRange: '日期范围',
                thRank: '排名',
                thAddress: '地址',
                thShare: '份额 %',
                thUnlockTime: '解锁时间',

                // Feedback
                feedback: '反馈',
                sendFeedback: '发送反馈',
                bugReport: '问题报告',
                feedbackPlaceholder: '告诉我们您的想法...',

                // Proposal Cards
                proposedBy: '提案人',
                created: '创建于',
                quorumProgress: '法定人数进度',
                totalVotes: '总票数',
                currentSplit: '当前分布',
                upcoming: '即将开始',
                daysRemaining: '天剩余',
                startsIn: '开始于',
                ended: '已结束',

                // Navigation & Header
                navInfo: '信息',
                navCommunityFeedback: '反馈',
                demoBadge: '演示',
                heroTitleVoting: '投票',

                // Tooltips
                tooltipVeFIL: '投票托管FIL：通过锁定FIL获得的治理代币。锁定时间越长 = 投票权越大。',
                tooltipPrototype: '这是一个演示环境。不使用真实的代币、钱包或资金。',
                tooltipQuorum: '有效投票所需的最低参与率。',

                // Wallet Modal
                walletModalTitle: '仅限演示模式',
                walletDisclaimerTitle: '这不是真实钱包',
                walletDisclaimerText: '您正在连接模拟演示钱包。不涉及任何真实的加密货币、代币或资金。这纯粹是为了演示目的。',
                walletFeature1: '不使用真实的FIL或加密货币',
                walletFeature2: '所有余额都是模拟演示数据',
                walletFeature3: '可以安全探索，没有任何风险',
                walletFeature4: '投票和交易不会记录在链上',
                walletCancel: '取消',
                walletContinue: '我已了解，继续',

                // Info Page
                infoAboutTitle: '关于此原型',
                infoDisclaimerTitle: '仅供演示',
                infoDisclaimerText: '这是一个用于探索veFIL治理概念的原型环境。不使用真实的钱包、代币或资金。所有数据都是为演示目的而模拟的。',
                infoAboutDesc: '此原型展示了投票托管FIL（veFIL）治理如何在Filecoin网络上运作。它允许您探索锁定FIL以获得投票权并参与治理提案的用户体验。',
                infoVeModelTitle: '投票托管模型',
                infoVeModelHighlight: '投票托管模型是DeFi和区块链治理中一种成熟的机制，它奖励长期承诺，并使代币持有者的利益与协议的长期成功保持一致。',
                infoVeModelDesc1: '通过给予长期利益相关者更多的投票权，网络可以确保决策由那些对网络未来投入最多的人做出。',
                infoVeModelDesc2: '该模型为治理公共产品资金提供了一个透明的框架，进一步朝着更加去中心化和社区驱动的方向发展。',
                infoGlossaryTitle: '关键术语',
                glossaryVeFIL: '锁定FIL时获得的治理代币。您收到的veFIL数量取决于锁定的金额和锁定期限。锁定时间越长 = veFIL越多 = 投票权越大。',
                glossaryQuorum: '投票有效所需的最低veFIL参与百分比。这确保决策获得足够的社区支持。',
                glossaryLockDuration: '您的FIL被锁定的时间段。范围从7天到2年（730天）。较长的期限提供更多的veFIL。',
                glossarySnapshot: '记录veFIL余额以确定投票资格的区块高度。只有在该区块持有的veFIL才能对提案进行投票。',
                glossaryFIP: '提议对Filecoin网络进行更改或改进的正式文件。FIP在实施前需经过社区审查。',
                infoFormulaTitle: 'veFIL公式',
                infoFormulaDesc: '您收到的veFIL数量根据您的锁定金额和期限计算：',
                infoFormulaExample: '例如，锁定100 FIL 365天（1年）将给您：100 × (365/730) × 1 = 50 veFIL',

                // Community Feedback Page
                feedbackPageTitle: '社区反馈',
                feedbackPageDesc: '分享您的想法，为他人的建议投票，帮助塑造veFIL治理的未来。',
                suggestFeature: '建议功能或改进',
                suggestionTitlePlaceholder: '功能标题...',
                suggestionDescPlaceholder: '描述您的建议...',
                typeFeature: '新功能',
                typeImprovement: '改进',
                typeBugFix: '错误修复',
                submitSuggestion: '提交建议',
                communitySuggestions: '社区建议'
            }
        };

        let currentLang = 'en';

        function switchLanguage(lang) {
            currentLang = lang;

            // Update language buttons
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === lang);
            });

            // Update all elements with data-i18n attribute
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.dataset.i18n;
                if (translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });

            // Update placeholders
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.dataset.i18nPlaceholder;
                if (translations[lang][key]) {
                    el.placeholder = translations[lang][key];
                }
            });

            // Re-render proposals with new language
            renderProposals();
        }

        // Sample data
        const proposals = [
            {
                id: 1,
                title: "Naming of NV27 to Golden Week",
                description: "Officially name the upcoming network upgrade NV27 to Golden Week.",
                status: "active",
                proposer: "f1abjxfbp274xpdqcpuaykwkfb43omjotacm2p3za",
                created: "2026-01-20",
                startTime: "2026-01-21",
                endTime: "2026-02-04",
                snapshotBlock: "3456789",
                quorumRequired: 30,
                quorumCurrent: 22.07,
                votesFor: 123456,
                votesAgainst: 45678,
                votesAbstain: 12345,
                totalVotes: 181479,
                voters: []
            },
            {
                id: 2,
                title: "Establish Monthly Community Call Time",
                description: "Set a recurring monthly community governance call for the third Thursday of each month at 16:00 UTC.",
                status: "active",
                proposer: "f1s5hbfgxihcbdj5jc35kv2eyoqpqdbahyo67ord",
                created: "2026-01-18",
                startTime: "2026-01-19",
                endTime: "2026-02-02",
                snapshotBlock: "3445678",
                quorumRequired: 30,
                quorumCurrent: 18.5,
                votesFor: 98765,
                votesAgainst: 23456,
                votesAbstain: 8901,
                totalVotes: 131122,
                voters: []
            },
            {
                id: 3,
                title: "Adopt Standard FIP Emoji System",
                description: "Use consistent emoji icons (🏮 cultural, 🔧 technical, 💰 economic) to categorize FIPs in GitHub discussions..",
                status: "passed",
                proposer: "f16tugakjlpyoomxy5uv2d6bdj7wcyr3ueofu7w7a",
                created: "2026-01-10",
                startTime: "2026-01-11",
                endTime: "2026-01-25",
                snapshotBlock: "3423456",
                quorumRequired: 30,
                quorumCurrent: 35.2,
                votesFor: 234567,
                votesAgainst: 45678,
                votesAbstain: 12345,
                totalVotes: 292590,
                voters: [
                    { address: "f1xm3ncpkubjzjwqxvkfxvzfhqcj7whnqkqvqcnai", power: 45678, share: 15.61 },
                    { address: "f1rqbholj5spu4p3lklhqf3p3n7hc5x6cdthsxqky", power: 34567, share: 11.82 },
                    { address: "f1kcpvnmf3dkytwjn2c4ew6ktm4dz7vdtxo5p2owi", power: 23456, share: 8.02 }
                ]
            },
            {
                id: 4,
                title: "Host Annual Governance Summit",
                description: "Organize a yearly in-person governance summit rotating between major Filecoin community hubs.",
                status: "failed",
                proposer: "f1v3ewkqvqb7m3ndvzbjklmipxqdmw6ebtm3kzxrq",
                created: "2026-01-05",
                startTime: "2026-01-06",
                endTime: "2026-01-20",
                snapshotBlock: "3412345",
                quorumRequired: 30,
                quorumCurrent: 15.3,
                votesFor: 45678,
                votesAgainst: 78901,
                votesAbstain: 5432,
                totalVotes: 130011,
                voters: []
            },
            {
                id: 5,
                title: "Translate FIP Summaries to Mandarin",
                description: "Provide official Mandarin translations for FIP abstracts to improve accessibility for Chinese-speaking community members.",
                status: "upcoming",
                proposer: "f1zk5mnyqvuxjpxlwxct6uowvmwhbj3kwnbp3squa",
                created: "2026-01-26",
                startTime: "2026-01-30",
                endTime: "2026-02-13",
                snapshotBlock: "3467890",
                quorumRequired: 30,
                quorumCurrent: 0,
                votesFor: 0,
                votesAgainst: 0,
                votesAbstain: 0,
                totalVotes: 0,
                voters: []
            }
        ];

        const depositsData = [
            { week: 'Week 1', deposits: 12500, dateRange: 'Dec 1-7, 2024' },
            { week: 'Week 2', deposits: 15200, dateRange: 'Dec 8-14, 2024' },
            { week: 'Week 3', deposits: 18900, dateRange: 'Dec 15-21, 2024' },
            { week: 'Week 4', deposits: 14300, dateRange: 'Dec 22-28, 2024' },
            { week: 'Week 5', deposits: 16800, dateRange: 'Dec 29-Jan 4, 2025' },
            { week: 'Week 6', deposits: 21500, dateRange: 'Jan 5-11, 2025' },
            { week: 'Week 7', deposits: 19200, dateRange: 'Jan 12-18, 2025' },
            { week: 'Week 8', deposits: 23400, dateRange: 'Jan 19-25, 2025' }
        ];

        const holdersData = [
            { rank: 1, address: 'f1d6wnwmhqxsj7nkmvkfoxmvpfuykfq4c5lmw2rji', veFIL: 145678, share: 11.8, unlock: '2026-01-15' },
            { rank: 2, address: 'f1pgjm2hdkvnobgbxlcztmxyoq2xhm3wtqfwvkqra', veFIL: 123456, share: 10.0, unlock: '2025-12-20' },
            { rank: 3, address: 'f1qpensj4o3xfxlwthzvb7e2kzqnm5wmhxqnbxwhi', veFIL: 98765, share: 8.0, unlock: '2026-03-10' },
            { rank: 4, address: 'f1zk5mnyqvuxjpxlwxct6uowvmwhbj3kwnbp3squa', veFIL: 87654, share: 7.1, unlock: '2025-11-05' },
            { rank: 5, address: 'f1zk5mnyqvuxjpxlwxct6uowvmwhbj3kwnbp3squa', veFIL: 76543, share: 6.2, unlock: '2026-02-28' },
            { rank: 6, address: 'f1zk5mnyqvuxjpxlwxct6uowvmwhbj3kwnbp3squa', veFIL: 65432, share: 5.3, unlock: '2025-10-15' },
            { rank: 7, address: 'f1zk5mnyqvuxjpxlwxct6uowvmwhbj3kwnbp3squa', veFIL: 54321, share: 4.4, unlock: '2026-04-20' },
            { rank: 8, address: 'f1zk5mnyqvuxjpxlwxct6uowvmwhbj3kwnbp3squa', veFIL: 43210, share: 3.5, unlock: '2025-09-30' }
        ];

        // =============================================================================
        // STATE MANAGEMENT
        // =============================================================================
        // NOTE: This is a prototype with client-side only authentication and state.
        // In production, all state changes (wallet connection, voting, locking, rewards)
        // must be validated server-side or on-chain. Current implementation is for
        // demonstration purposes only and should NOT be used in production without:
        //   1. Server-side vote validation and deduplication
        //   2. On-chain transaction verification for FIL locking
        //   3. Cryptographic wallet signature verification
        //   4. Rate limiting and anti-spam measures
        // =============================================================================
        let walletConnected = false;
        let userAddress = '';
        let userFIL = 1500.75;
        let userVeFIL = 0;
        let userLockedFIL = 0;
        let currentFilter = 'active';
        let currentSort = 'ending-soon';
        let lockAmount = 0;
        let lockDuration = 90;
        let selectedProposal = null;
        let userVotes = {};
        let hasClaimedThisSession = false;  // Prevents infinite reward claiming
        let isLockInProgress = false;       // Prevents race condition in lock

        // =============================================================================
        // SECURITY HELPER FUNCTIONS
        // =============================================================================

        // HTML escaping to prevent XSS attacks
        function escapeHtml(unsafe) {
            if (typeof unsafe !== 'string') return '';
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // Safe division for percentage calculations (prevents NaN/Infinity)
        function safePercentage(value, total, decimals = 1) {
            if (total === 0 || !Number.isFinite(total)) return '0.0';
            const percentage = (value / total) * 100;
            return Number.isFinite(percentage) ? percentage.toFixed(decimals) : '0.0';
        }

        // Auto-refresh expired proposals for demo purposes
        // Moves expired proposal dates forward by 1 week increments to keep proposals cycling
        function refreshExpiredProposals() {
            const now = new Date();
            const oneWeekMs = 7 * 24 * 60 * 60 * 1000;

            proposals.forEach(p => {
                const endDate = new Date(p.endTime);

                // If proposal has expired, move dates forward by enough weeks to make it active
                if (now > endDate) {
                    const startDate = new Date(p.startTime);
                    const createdDate = new Date(p.created);

                    // Calculate how many weeks have passed since expiry
                    const weeksExpired = Math.ceil((now - endDate) / oneWeekMs);
                    const shiftMs = weeksExpired * oneWeekMs;

                    // Shift all dates forward
                    p.created = new Date(createdDate.getTime() + shiftMs).toISOString().split('T')[0];
                    p.startTime = new Date(startDate.getTime() + shiftMs).toISOString().split('T')[0];
                    p.endTime = new Date(endDate.getTime() + shiftMs).toISOString().split('T')[0];

                    // Reset to active status if it was passed/failed
                    if (p.status === 'passed' || p.status === 'failed') {
                        p.status = 'active';
                    }
                }
            });
        }

        // Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const page = link.dataset.page;
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                link.classList.add('active');
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                document.getElementById(page).classList.add('active');
            });
        });

        // Wallet connection
        document.getElementById('walletBtn').addEventListener('click', () => {
            if (!walletConnected) {
                openWalletDisclaimer();
            } else {
                toggleAccountPanel();
            }
        });

        function openWalletDisclaimer() {
            document.getElementById('walletDisclaimerModal').classList.add('active');
        }

        function closeWalletDisclaimer() {
            document.getElementById('walletDisclaimerModal').classList.remove('active');
        }

        function proceedWithDemoWallet() {
            closeWalletDisclaimer();
            connectWallet();
        }

        function connectWallet() {
            // Simulate wallet connection
            walletConnected = true;
            userAddress = 'f1qpensj4o3xfxlwthzvb7e2kzqnm5wmhxqnbxwhi';

            const walletBtn = document.getElementById('walletBtn');
            walletBtn.textContent = userAddress.substring(0, 6) + '...' + userAddress.substring(38);
            walletBtn.className = 'wallet-connected';

            updateAccountPanel();
        }

        function disconnectWallet() {
            // Reset all user state completely
            walletConnected = false;
            userAddress = '';
            userFIL = 1500.75;  // Reset to initial value
            userVeFIL = 0;
            userLockedFIL = 0;
            userVotes = {};  // Clear vote history
            lockAmount = 0;
            lockDuration = 90;  // Reset to default
            hasClaimedThisSession = false;  // Allow claiming again after reconnect
            isLockInProgress = false;  // Reset lock state

            // Reset UI
            const walletBtn = document.getElementById('walletBtn');
            walletBtn.textContent = 'Connect Wallet';
            walletBtn.className = 'wallet-btn';

            // Reset lock modal inputs if visible
            const lockAmountInput = document.getElementById('lockAmount');
            if (lockAmountInput) {
                lockAmountInput.value = '';
            }

            // Reset duration slider to default
            const durationSlider = document.getElementById('durationSlider');
            if (durationSlider) {
                durationSlider.value = 90;
            }
            const selectedDuration = document.getElementById('selectedDuration');
            if (selectedDuration) {
                selectedDuration.textContent = '90';
            }

            // Reset duration presets
            document.querySelectorAll('.duration-preset').forEach(p => p.classList.remove('active'));
            const defaultPreset = document.querySelector('.duration-preset[data-days="90"]');
            if (defaultPreset) {
                defaultPreset.classList.add('active');
            }

            closeAccountPanel();
            closeLockModal();

            // Re-render proposals to update voting UI
            renderProposals();
        }

        function toggleAccountPanel() {
            const panel = document.getElementById('accountPanel');
            panel.classList.toggle('active');
        }

        function closeAccountPanel() {
            document.getElementById('accountPanel').classList.remove('active');
        }

        function updateAccountPanel() {
            document.getElementById('accountAddress').textContent = 
                userAddress.substring(0, 6) + '...' + userAddress.substring(38);
            document.getElementById('accountFIL').textContent = userFIL.toFixed(2) + ' FIL';
            document.getElementById('accountLockedFIL').textContent = userLockedFIL.toFixed(2) + ' FIL';
            document.getElementById('accountVeFIL').textContent = userVeFIL.toFixed(2) + ' veFIL';
            document.getElementById('accountAPR').textContent = '12.5%';
            
            if (userLockedFIL > 0) {
                const endDate = new Date();
                endDate.setDate(endDate.getDate() + lockDuration);
                const remainingDays = Math.ceil((endDate - new Date()) / (1000 * 60 * 60 * 24));
                
                document.getElementById('activeLocks').innerHTML = `
                    <div style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid #e2e8f0;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span style="color: #718096;">Amount</span>
                            <span style="font-weight: 600;">${userLockedFIL.toFixed(2)} FIL</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #718096;">Remaining</span>
                            <span style="font-weight: 600; color: #0066ff;">${remainingDays} days</span>
                        </div>
                    </div>
                `;
            }
            
            const claimable = userVeFIL * 0.05;
            document.getElementById('accountClaimable').textContent = claimable.toFixed(2) + ' FIL';
            // Disable claim button if no rewards OR already claimed this session
            document.getElementById('claimBtn').disabled = claimable === 0 || hasClaimedThisSession;
        }

        // Proposals
        function renderProposals() {
            let filtered = proposals;
            
            if (currentFilter !== 'all') {
                filtered = proposals.filter(p => p.status === currentFilter);
            }
            
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();
            if (searchTerm) {
                filtered = filtered.filter(p => 
                    p.title.toLowerCase().includes(searchTerm) || 
                    p.description.toLowerCase().includes(searchTerm)
                );
            }
            
            filtered.sort((a, b) => {
                if (currentSort === 'newest') {
                    return new Date(b.created) - new Date(a.created);
                } else if (currentSort === 'oldest') {
                    return new Date(a.created) - new Date(b.created);
                } else if (currentSort === 'ending-soon') {
                    return new Date(a.endTime) - new Date(b.endTime);
                }
            });
            
            const container = document.getElementById('proposalsList');
            const t = translations[currentLang];
            container.innerHTML = filtered.map(p => `
                <div class="proposal-card" onclick="openProposal(${parseInt(p.id, 10)})">
                    <div class="proposal-header">
                        <div>
                            <div class="status-badge status-${escapeHtml(p.status)}">${escapeHtml(getStatusLabel(p.status))}</div>
                        </div>
                        <div style="text-align: right; color: #718096; font-size: 0.9rem;">
                            ${escapeHtml(getTimeRemaining(p))}
                        </div>
                    </div>
                    <h3 class="proposal-title">${escapeHtml(p.title)}</h3>
                    <div class="proposal-meta">
                        ${escapeHtml(t.proposedBy)} ${escapeHtml(p.proposer.substring(0, 6))}...${escapeHtml(p.proposer.substring(38))} •
                        ${escapeHtml(t.created)} ${escapeHtml(formatDate(p.created))}
                    </div>
                    <p class="proposal-description">${escapeHtml(p.description)}</p>
                    <div class="proposal-stats">
                        <div class="proposal-stat">
                            <div class="proposal-stat-label">${escapeHtml(t.quorumProgress)}</div>
                            <div class="proposal-stat-value">${p.quorumCurrent.toFixed(2)}% of ${p.quorumRequired}%</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${Math.min(safePercentage(p.quorumCurrent, p.quorumRequired, 2), 100)}%"></div>
                            </div>
                        </div>
                        <div class="proposal-stat">
                            <div class="proposal-stat-label">${escapeHtml(t.totalVotes)}</div>
                            <div class="proposal-stat-value">${p.totalVotes.toLocaleString()} veFIL</div>
                        </div>
                        <div class="proposal-stat">
                            <div class="proposal-stat-label">${escapeHtml(t.currentSplit)}</div>
                            <div class="proposal-stat-value">
                                ${p.totalVotes === 0 ? escapeHtml(t.upcoming) : `${safePercentage(p.votesFor, p.totalVotes)}% For / ${safePercentage(p.votesAgainst, p.totalVotes)}% Against`}
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getStatusLabel(status) {
            const statusLabels = {
                en: { active: 'ACTIVE', passed: 'PASSED', failed: 'FAILED', upcoming: 'UPCOMING' },
                zh: { active: '进行中', passed: '已通过', failed: '未通过', upcoming: '即将开始' }
            };
            return statusLabels[currentLang][status] || status.toUpperCase();
        }

        function getTimeRemaining(proposal) {
            const t = translations[currentLang];
            const now = new Date();
            const end = new Date(proposal.endTime);
            const diff = end - now;

            if (proposal.status === 'upcoming') {
                const start = new Date(proposal.startTime);
                const startDiff = start - now;
                const days = Math.ceil(startDiff / (1000 * 60 * 60 * 24));
                return currentLang === 'zh' ? `${days} 天后开始` : `Starts in ${days} days`;
            } else if (proposal.status === 'active') {
                const days = Math.ceil(diff / (1000 * 60 * 60 * 24));
                return currentLang === 'zh' ? `剩余 ${days} 天` : `${days} days remaining`;
            } else {
                return currentLang === 'zh' ? `已于 ${formatDate(proposal.endTime)} 结束` : `Ended ${formatDate(proposal.endTime)}`;
            }
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const locale = currentLang === 'zh' ? 'zh-CN' : 'en-US';
            const options = { month: 'short', day: 'numeric', year: 'numeric' };
            return date.toLocaleDateString(locale, options);
        }

        // Filter tabs
        document.querySelectorAll('.filter-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                currentFilter = tab.dataset.filter;
                document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                renderProposals();
            });
        });

        // Search
        document.getElementById('searchBox').addEventListener('input', () => {
            renderProposals();
        });

        // Sort
        document.getElementById('sortSelect').addEventListener('change', (e) => {
            currentSort = e.target.value;
            renderProposals();
        });

        // Lock FIL Modal
        function openLockModal() {
            if (!walletConnected) {
                alert('Please connect your wallet first');
                return;
            }
            document.getElementById('lockModal').classList.add('active');
            updateLockPreview();
        }

        function closeLockModal() {
            document.getElementById('lockModal').classList.remove('active');
            document.getElementById('lockAmount').value = '';
            lockAmount = 0;
            updateLockPreview();
        }

        document.getElementById('lockFILBannerBtn').addEventListener('click', openLockModal);

        document.getElementById('lockAmount').addEventListener('input', (e) => {
            const rawValue = e.target.value;

            // Parse and validate
            let parsed = parseFloat(rawValue);

            // Handle invalid values
            if (isNaN(parsed) || !Number.isFinite(parsed)) {
                lockAmount = 0;
            } else if (parsed < 0) {
                lockAmount = 0;
                e.target.value = '0';
            } else {
                // Limit to 8 decimal places (standard for crypto)
                lockAmount = Math.floor(parsed * 100000000) / 100000000;

                // Cap at maximum balance
                if (lockAmount > userFIL) {
                    lockAmount = userFIL;
                }
            }

            updateLockPreview();
        });

        document.querySelectorAll('.duration-preset').forEach(preset => {
            preset.addEventListener('click', (e) => {
                const days = parseInt(preset.dataset.days);
                lockDuration = days;
                document.getElementById('durationSlider').value = days;
                document.getElementById('selectedDuration').textContent = days;
                document.querySelectorAll('.duration-preset').forEach(p => p.classList.remove('active'));
                preset.classList.add('active');
                updateLockPreview();
            });
        });

        document.getElementById('durationSlider').addEventListener('input', (e) => {
            lockDuration = parseInt(e.target.value);
            document.getElementById('selectedDuration').textContent = lockDuration;
            document.querySelectorAll('.duration-preset').forEach(p => p.classList.remove('active'));
            updateLockPreview();
        });

        function setMaxAmount() {
            document.getElementById('lockAmount').value = userFIL.toFixed(2);
            lockAmount = userFIL;
            updateLockPreview();
        }

        function updateLockPreview() {
            const multiplier = lockDuration / 730;
            const veFIL = lockAmount * multiplier;
            const endDate = new Date();
            endDate.setDate(endDate.getDate() + lockDuration);
            
            document.getElementById('previewVeFIL').textContent = veFIL.toFixed(2) + ' veFIL';
            document.getElementById('previewMultiplier').textContent = multiplier.toFixed(2) + 'x';
            document.getElementById('previewEndDate').textContent = formatDate(endDate.toISOString().split('T')[0]);
            
            const continueBtn = document.getElementById('lockContinueBtn');
            continueBtn.disabled = lockAmount <= 0 || lockAmount > userFIL;
        }

        function submitLock() {
            // Prevent race condition - check if lock is already in progress
            if (isLockInProgress) {
                return;
            }

            if (lockAmount <= 0 || lockAmount > userFIL || !Number.isFinite(lockAmount)) {
                document.getElementById('lockError').textContent = 'Invalid lock amount';
                document.getElementById('lockError').classList.add('active');
                return;
            }

            // Disable button and set lock in progress
            const lockBtn = document.getElementById('lockContinueBtn');
            isLockInProgress = true;
            lockBtn.disabled = true;
            const originalText = lockBtn.textContent;
            lockBtn.textContent = 'Processing...';

            // Clear any previous error
            document.getElementById('lockError').classList.remove('active');

            // Simulate transaction
            setTimeout(() => {
                try {
                    userFIL -= lockAmount;
                    userLockedFIL += lockAmount;
                    const multiplier = lockDuration / 730;
                    userVeFIL += lockAmount * multiplier;

                    updateAccountPanel();

                    document.getElementById('lockSuccess').textContent = 'FIL locked successfully! Your veFIL has been minted.';
                    document.getElementById('lockSuccess').classList.add('active');

                    setTimeout(() => {
                        closeLockModal();
                        document.getElementById('lockSuccess').classList.remove('active');
                    }, 2000);
                } finally {
                    // Re-enable button
                    isLockInProgress = false;
                    lockBtn.disabled = false;
                    lockBtn.textContent = originalText;
                }
            }, 1500);
        }

        function claimRewards() {
            // Prevent infinite claiming - only allow once per session
            if (hasClaimedThisSession) {
                alert('You have already claimed rewards this session.');
                return;
            }

            const claimable = userVeFIL * 0.05;
            if (claimable > 0) {
                userFIL += claimable;
                hasClaimedThisSession = true;
                updateAccountPanel();
                alert(`Claimed ${claimable.toFixed(2)} FIL successfully!`);
            }
        }

        // Proposal Detail Modal
        function openProposal(id) {
            selectedProposal = proposals.find(p => p.id === id);
            if (!selectedProposal) return;

            document.getElementById('proposalModalTitle').textContent = selectedProposal.title;

            const detailContent = `
                <div class="detail-header">
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                        <div class="status-badge status-${escapeHtml(selectedProposal.status)}">${escapeHtml(selectedProposal.status.toUpperCase())}</div>
                        <span style="color: #718096;">${escapeHtml(getTimeRemaining(selectedProposal))}</span>
                    </div>
                    <div class="detail-meta">
                        <span>Proposer: ${escapeHtml(selectedProposal.proposer)}</span>
                        <span>Start: ${escapeHtml(formatDate(selectedProposal.startTime))}</span>
                        <span>End: ${escapeHtml(formatDate(selectedProposal.endTime))}</span>
                        <span>Snapshot: Block #${escapeHtml(selectedProposal.snapshotBlock)}</span>
                    </div>
                </div>
                <div class="detail-body">
                    <p>${escapeHtml(selectedProposal.description)}</p>
                </div>
            `;

            document.getElementById('proposalDetailContent').innerHTML = detailContent;

            // Voting module - check for existing vote first (prevent double-voting)
            const votingModule = document.getElementById('votingModule');
            const existingVote = userVotes[selectedProposal.id];

            if (selectedProposal.status === 'active' && walletConnected && userVeFIL > 0) {
                if (existingVote) {
                    // User already voted - show their vote instead of voting options
                    votingModule.style.display = 'block';
                    votingModule.innerHTML = `
                        <h3 style="margin-bottom: 1rem;">Your Vote</h3>
                        <div style="padding: 1rem; background: #f0f7ff; border-radius: 8px; text-align: center;">
                            <p style="color: #0066ff; font-weight: 600; margin: 0;">
                                You voted: ${escapeHtml(existingVote.charAt(0).toUpperCase() + existingVote.slice(1))}
                            </p>
                            <p style="color: #718096; font-size: 0.9rem; margin: 0.5rem 0 0 0;">
                                Voting power: ${userVeFIL.toLocaleString()} veFIL
                            </p>
                        </div>
                    `;
                } else {
                    // Show voting options
                    votingModule.style.display = 'block';
                    votingModule.innerHTML = `
                        <h3 style="margin-bottom: 1rem;">Cast Your Vote</h3>
                        <div class="voting-options">
                            <label class="vote-option">
                                <input type="radio" name="vote" value="for">
                                <div>✓ For</div>
                            </label>
                            <label class="vote-option">
                                <input type="radio" name="vote" value="against">
                                <div>✗ Against</div>
                            </label>
                            <label class="vote-option">
                                <input type="radio" name="vote" value="abstain">
                                <div>− Abstain</div>
                            </label>
                        </div>
                        <button class="btn-primary" id="submitVoteBtn" disabled onclick="submitVote()" style="width: 100%;">Submit Vote</button>
                    `;

                    document.querySelectorAll('input[name="vote"]').forEach(input => {
                        input.addEventListener('change', (e) => {
                            document.querySelectorAll('.vote-option').forEach(opt => opt.classList.remove('selected'));
                            e.target.parentElement.classList.add('selected');
                            document.getElementById('submitVoteBtn').disabled = false;
                        });
                    });
                }
            } else {
                votingModule.style.display = 'none';
            }

            // Results module - using safePercentage to prevent division by zero
            const resultsHTML = `
                <h3 style="margin-bottom: 1rem;">Voting Results</h3>
                <div class="result-item">
                    <div class="result-header">
                        <span class="result-label">For</span>
                        <span class="result-percentage">${safePercentage(selectedProposal.votesFor, selectedProposal.totalVotes)}% (${selectedProposal.votesFor.toLocaleString()} veFIL)</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${safePercentage(selectedProposal.votesFor, selectedProposal.totalVotes)}%; background: #10b981;"></div>
                    </div>
                </div>
                <div class="result-item">
                    <div class="result-header">
                        <span class="result-label">Against</span>
                        <span class="result-percentage">${safePercentage(selectedProposal.votesAgainst, selectedProposal.totalVotes)}% (${selectedProposal.votesAgainst.toLocaleString()} veFIL)</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${safePercentage(selectedProposal.votesAgainst, selectedProposal.totalVotes)}%; background: #ef4444;"></div>
                    </div>
                </div>
                <div class="result-item">
                    <div class="result-header">
                        <span class="result-label">Abstain</span>
                        <span class="result-percentage">${safePercentage(selectedProposal.votesAbstain, selectedProposal.totalVotes)}% (${selectedProposal.votesAbstain.toLocaleString()} veFIL)</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${safePercentage(selectedProposal.votesAbstain, selectedProposal.totalVotes)}%; background: #94a3b8;"></div>
                    </div>
                </div>
                <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #e2e8f0;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span style="font-weight: 600;">Quorum Status</span>
                        <span style="color: ${selectedProposal.quorumCurrent >= selectedProposal.quorumRequired ? '#10b981' : '#718096'};">
                            ${selectedProposal.quorumCurrent >= selectedProposal.quorumRequired ? 'Reached' : 'Not Reached'}
                        </span>
                    </div>
                    <div style="color: #718096;">
                        ${selectedProposal.quorumCurrent.toFixed(2)}% voted (${selectedProposal.quorumRequired}% required)
                    </div>
                </div>
            `;

            document.getElementById('resultsModule').innerHTML = resultsHTML;

            // Voter table for passed proposals
            if (selectedProposal.status === 'passed' && selectedProposal.voters.length > 0) {
                const voterTableHTML = `
                    <div class="voter-table">
                        <h3 style="margin-bottom: 1rem;">Voters</h3>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Address</th>
                                        <th>Voting Power</th>
                                        <th>Share %</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${selectedProposal.voters.map(v => `
                                        <tr>
                                            <td>${escapeHtml(v.address.substring(0, 6))}...${escapeHtml(v.address.substring(38))}</td>
                                            <td>${Number(v.power).toLocaleString()} veFIL</td>
                                            <td>${Number(v.share).toFixed(2)}%</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
                document.getElementById('resultsModule').innerHTML += voterTableHTML;
            }

            document.getElementById('proposalModal').classList.add('active');
        }

        function closeProposalModal() {
            document.getElementById('proposalModal').classList.remove('active');
            selectedProposal = null;
        }

        function submitVote() {
            const selectedVote = document.querySelector('input[name="vote"]:checked');
            if (!selectedVote) return;

            // Check if user has already voted on this proposal (prevent double-voting)
            if (userVotes[selectedProposal.id]) {
                alert('You have already voted on this proposal.');
                return;
            }

            const vote = selectedVote.value;
            const submitBtn = document.getElementById('submitVoteBtn');

            // Disable button during submission to prevent double-click
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';

            // Simulate vote submission
            setTimeout(() => {
                userVotes[selectedProposal.id] = vote;

                // Update proposal votes
                if (vote === 'for') {
                    selectedProposal.votesFor += userVeFIL;
                } else if (vote === 'against') {
                    selectedProposal.votesAgainst += userVeFIL;
                } else {
                    selectedProposal.votesAbstain += userVeFIL;
                }
                selectedProposal.totalVotes += userVeFIL;
                selectedProposal.quorumCurrent = (selectedProposal.totalVotes / 1234567) * 100;

                document.getElementById('voteSuccess').textContent = 'Vote submitted successfully!';
                document.getElementById('voteSuccess').classList.add('active');

                renderProposals();

                setTimeout(() => {
                    closeProposalModal();
                    document.getElementById('voteSuccess').classList.remove('active');
                    submitBtn.textContent = 'Submit Vote';
                }, 2000);
            }, 1500);
        }

        // Analytics
        document.querySelectorAll('.toggle-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const view = btn.dataset.view;
                document.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                document.getElementById('depositsView').style.display = view === 'deposits' ? 'block' : 'none';
                document.getElementById('holdersView').style.display = view === 'holders' ? 'block' : 'none';
            });
        });

        function renderDepositsChart() {
            const chart = document.getElementById('depositsChart');
            const maxDeposits = Math.max(...depositsData.map(d => d.deposits));

            chart.innerHTML = depositsData.map(d => `
                <div class="bar" style="height: ${(d.deposits / maxDeposits * 100)}%;">
                    <div class="bar-label">${d.week}</div>
                </div>
            `).join('');
        }

        function renderDepositsTable() {
            const tbody = document.querySelector('#depositsTable tbody');
            const totalDeposits = depositsData.reduce((sum, d) => sum + d.deposits, 0);

            tbody.innerHTML = depositsData.map(d => `
                <tr>
                    <td>${d.week}</td>
                    <td>${d.deposits.toLocaleString()} FIL</td>
                    <td>${d.dateRange}</td>
                </tr>
            `).join('') + `
                <tr style="font-weight: 600; background: #f7fafc;">
                    <td>Total</td>
                    <td>${totalDeposits.toLocaleString()} FIL</td>
                    <td>-</td>
                </tr>
            `;
        }

        function renderHoldersChart() {
            const chart = document.getElementById('holdersChart');
            const maxVeFIL = Math.max(...holdersData.map(d => d.veFIL));
            
            chart.innerHTML = holdersData.map(d => `
                <div class="bar" style="height: ${(d.veFIL / maxVeFIL * 100)}%;">
                    <div class="bar-label">Rank ${d.rank}</div>
                </div>
            `).join('');
        }

        function renderHoldersTable() {
            const tbody = document.querySelector('#holdersTable tbody');
            
            tbody.innerHTML = holdersData.map(d => `
                <tr>
                    <td>${d.rank}</td>
                    <td>${d.address.substring(0, 6)}...${d.address.substring(38)}</td>
                    <td>${d.veFIL.toLocaleString()} veFIL</td>
                    <td>${d.share.toFixed(1)}%</td>
                    <td>${formatDate(d.unlock)}</td>
                </tr>
            `).join('');
        }

        // Feedback Modal
        let feedbackType = 'feedback';

        function toggleFeedbackModal() {
            const modal = document.getElementById('feedbackModal');
            modal.classList.toggle('active');
        }

        function selectFeedbackType(btn) {
            document.querySelectorAll('.feedback-type-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            feedbackType = btn.dataset.type;
        }

        function submitFeedback() {
            const message = document.getElementById('feedbackMessage').value.trim();
            if (!message) {
                alert('Please enter your feedback message.');
                return;
            }

            const subject = feedbackType === 'bug'
                ? encodeURIComponent('Bug Report: veFIL Governance Tool')
                : encodeURIComponent('Feedback: veFIL Governance Tool');
            const body = encodeURIComponent(`Type: ${feedbackType === 'bug' ? 'Bug Report' : 'Feedback'}\n\n${message}\n\n---\nSent from veFIL Governance Tool`);

            window.location.href = `mailto:michael@fil.org?subject=${subject}&body=${body}`;

            // Clear and close
            document.getElementById('feedbackMessage').value = '';
            toggleFeedbackModal();
        }

        // Close feedback modal when clicking outside
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('feedbackModal');
            const fab = document.querySelector('.feedback-fab');
            if (modal.classList.contains('active') &&
                !modal.contains(e.target) &&
                !fab.contains(e.target)) {
                modal.classList.remove('active');
            }
        });

        // Update filter counts
        function updateFilterCounts() {
            const counts = {
                all: proposals.length,
                active: proposals.filter(p => p.status === 'active').length,
                passed: proposals.filter(p => p.status === 'passed').length,
                failed: proposals.filter(p => p.status === 'failed').length,
                upcoming: proposals.filter(p => p.status === 'upcoming').length
            };

            document.getElementById('countAll').textContent = `(${counts.all})`;
            document.getElementById('countActive').textContent = `(${counts.active})`;
            document.getElementById('countPassed').textContent = `(${counts.passed})`;
            document.getElementById('countFailed').textContent = `(${counts.failed})`;
            document.getElementById('countUpcoming').textContent = `(${counts.upcoming})`;
        }

        // Community Suggestions
        let suggestions = [
            {
                id: 1,
                title: 'Add delegation support for veFIL',
                description: 'Allow users to delegate their veFIL voting power to trusted representatives without transferring their tokens.',
                type: 'feature',
                votes: 24,
                userVote: null,
                date: '2026-01-25'
            },
            {
                id: 2,
                title: 'Mobile-responsive improvements',
                description: 'Improve the mobile experience with better touch interactions and responsive layouts for smaller screens.',
                type: 'improvement',
                votes: 18,
                userVote: null,
                date: '2026-01-24'
            },
            {
                id: 3,
                title: 'Add proposal discussion threads',
                description: 'Enable community members to discuss proposals directly within the governance tool before voting.',
                type: 'feature',
                votes: 31,
                userVote: null,
                date: '2026-01-23'
            },
            {
                id: 4,
                title: 'Show historical voting data',
                description: 'Display past voting history and participation metrics for transparency and accountability.',
                type: 'improvement',
                votes: 15,
                userVote: null,
                date: '2026-01-22'
            },
            {
                id: 5,
                title: 'Email notifications for proposals',
                description: 'Option to receive email alerts when new proposals are created or when voting periods are ending.',
                type: 'feature',
                votes: 22,
                userVote: null,
                date: '2026-01-20'
            }
        ];

        let nextSuggestionId = 6;

        function renderSuggestions() {
            const container = document.getElementById('suggestionsList');
            const sortedSuggestions = [...suggestions].sort((a, b) => b.votes - a.votes);

            container.innerHTML = sortedSuggestions.map(s => `
                <div class="suggestion-card">
                    <div class="suggestion-votes">
                        <button class="vote-btn ${s.userVote === 'up' ? 'voted-up' : ''}" onclick="voteSuggestion(${parseInt(s.id, 10)}, 'up')">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />
                            </svg>
                        </button>
                        <span class="vote-count">${parseInt(s.votes, 10)}</span>
                        <button class="vote-btn ${s.userVote === 'down' ? 'voted-down' : ''}" onclick="voteSuggestion(${parseInt(s.id, 10)}, 'down')">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>
                    </div>
                    <div class="suggestion-content">
                        <div class="suggestion-title">${escapeHtml(s.title)}</div>
                        <div class="suggestion-description">${escapeHtml(s.description)}</div>
                        <div class="suggestion-meta">
                            <span class="suggestion-tag ${escapeHtml(s.type)}">${escapeHtml(getTypeLabel(s.type))}</span>
                            ${escapeHtml(formatDate(s.date))}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getTypeLabel(type) {
            const labels = {
                en: { feature: 'Feature', improvement: 'Improvement', bug: 'Bug Fix' },
                zh: { feature: '功能', improvement: '改进', bug: '错误修复' }
            };
            return labels[currentLang][type] || type;
        }

        function voteSuggestion(id, direction) {
            const suggestion = suggestions.find(s => s.id === id);
            if (!suggestion) return;

            // Remove previous vote if exists
            if (suggestion.userVote === 'up') {
                suggestion.votes--;
            } else if (suggestion.userVote === 'down') {
                suggestion.votes++;
            }

            // Apply new vote or toggle off
            if (suggestion.userVote === direction) {
                suggestion.userVote = null;
            } else {
                suggestion.userVote = direction;
                if (direction === 'up') {
                    suggestion.votes++;
                } else {
                    suggestion.votes--;
                }
            }

            renderSuggestions();
        }

        function addSuggestion() {
            const title = document.getElementById('suggestionTitle').value.trim();
            const description = document.getElementById('suggestionDesc').value.trim();
            const type = document.getElementById('suggestionType').value;

            if (!title || !description) {
                alert(currentLang === 'zh' ? '请填写标题和描述' : 'Please fill in both title and description');
                return;
            }

            const newSuggestion = {
                id: nextSuggestionId++,
                title: title,
                description: description,
                type: type,
                votes: 1,
                userVote: 'up',
                date: new Date().toISOString().split('T')[0]
            };

            suggestions.unshift(newSuggestion);
            renderSuggestions();

            // Clear form
            document.getElementById('suggestionTitle').value = '';
            document.getElementById('suggestionDesc').value = '';
            document.getElementById('suggestionType').value = 'feature';

            alert(currentLang === 'zh' ? '建议已提交！' : 'Suggestion submitted!');
        }

        // Initialize
        refreshExpiredProposals();  // Auto-cycle expired proposals for demo
        updateFilterCounts();
        renderProposals();
        renderDepositsChart();
        renderDepositsTable();
        renderHoldersChart();
        renderHoldersTable();
        renderSuggestions();
    </script>
</body>
</html>
